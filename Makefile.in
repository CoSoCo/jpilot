
#Pilot flags (include dir), and Libraries
PILOT_FLAGS=@PILOT_FLAGS@
PILOT_LIBS=@PILOT_LIBS@

#set CC to your compiler
CC = @CC@

# CC options
# japanese support
CCDEFINES = @DEFS@ -DBASE_DIR=\"@prefix@\"
CFLAGS = @cflags@

# CC options
OPTIONS = @ccoptions@ $(CCDEFINES) $(CFLAGS)

# GTK+ flags
GTKFLAGS = @GTK_CFLAGS@
# GTK+ libs
GTKLIBS = @GTK_LIBS@

all: jpilot

jpilot: jpilot.o datebook.o address.o todo.o memo.o \
	utils.o sync.o prefs.o log.o \
	datebook_gui.o address_gui.o todo_gui.o memo_gui.o \
	prefs_gui.o search_gui.o install_gui.o weekview_gui.o \
	monthview_gui.o \
	japanese.o
	$(CC) $(OPTIONS) $(PILOT_LIBS) $(GTKFLAGS) $(GTKLIBS) \
	jpilot.o datebook.o address.o todo.o memo.o \
	utils.o sync.o prefs.o log.o \
	datebook_gui.o address_gui.o todo_gui.o memo_gui.o \
	prefs_gui.o search_gui.o install_gui.o weekview_gui.o \
	monthview_gui.o \
	japanese.o \
	-o jpilot


jpilot.o: jpilot.c utils.h
	$(CC) $(OPTIONS) $(PILOT_FLAGS) $(GTKFLAGS) -c jpilot.c

datebook.o: datebook.c datebook.h utils.h
	$(CC) $(OPTIONS) $(PILOT_FLAGS) $(GTKFLAGS) -c datebook.c

address.o: address.c address.h utils.h
	$(CC) $(OPTIONS) $(PILOT_FLAGS) $(GTKFLAGS) -c address.c

todo.o: todo.c todo.h utils.h
	$(CC) $(OPTIONS) $(PILOT_FLAGS) $(GTKFLAGS) -c todo.c

memo.o: memo.c memo.h utils.h
	$(CC) $(OPTIONS) $(PILOT_FLAGS) $(GTKFLAGS) -c memo.c

datebook_gui.o: datebook_gui.c utils.h
	$(CC) $(OPTIONS) $(PILOT_FLAGS) $(GTKFLAGS) -c datebook_gui.c

address_gui.o: address_gui.c utils.h
	$(CC) $(OPTIONS) $(PILOT_FLAGS) $(GTKFLAGS) -c address_gui.c

todo_gui.o: todo_gui.c utils.h
	$(CC) $(OPTIONS) $(PILOT_FLAGS) $(GTKFLAGS) -c todo_gui.c

memo_gui.o: memo_gui.c utils.h
	$(CC) $(OPTIONS) $(PILOT_FLAGS) $(GTKFLAGS) -c memo_gui.c

search_gui.o: search_gui.c utils.h
	$(CC) $(OPTIONS) $(PILOT_FLAGS) $(GTKFLAGS) -c search_gui.c

prefs_gui.o: prefs_gui.c prefs.h utils.h
	$(CC) $(OPTIONS) $(PILOT_FLAGS) $(GTKFLAGS) -c prefs_gui.c

install_gui.o: install_gui.c utils.h
	$(CC) $(OPTIONS) $(PILOT_FLAGS) $(GTKFLAGS) -c install_gui.c

weekview_gui.o: weekview_gui.c utils.h
	$(CC) $(OPTIONS) $(PILOT_FLAGS) $(GTKFLAGS) -c weekview_gui.c

monthview_gui.o: monthview_gui.c utils.h
	$(CC) $(OPTIONS) $(PILOT_FLAGS) $(GTKFLAGS) -c monthview_gui.c

utils.o: utils.c utils.h
	$(CC) $(OPTIONS) $(PILOT_FLAGS) $(GTKFLAGS) -c utils.c

sync.o: sync.c sync.h
	$(CC) $(OPTIONS) $(PILOT_FLAGS) $(GTKFLAGS) -c sync.c

log.o: log.c log.h
	$(CC) $(OPTIONS) $(PILOT_FLAGS) $(GTKFLAGS) -c log.c

prefs.o: prefs.c utils.h prefs.h
	$(CC) $(OPTIONS) $(PILOT_FLAGS) $(GTKFLAGS) -c prefs.c

japanese.o: japanese.c japanese.h
	$(CC) $(OPTIONS) -c japanese.c

clean: 
	rm -f *.o *~ config.cache

distclean: 
	rm -f *.o *~ config.cache config.status jpilot

install:
#	./install-sh -d @prefix@/bin
	./install-sh -s -c -m 555 -g bin -o bin jpilot @prefix@/bin
	./install-sh -d -m 755 @prefix@/share/jpilot
	./install-sh -c -m 755 -g bin -o bin jpilotrc.blue @prefix@/share/jpilot
	./install-sh -c -m 755 -g bin -o bin jpilotrc.default @prefix@/share/jpilot
	./install-sh -c -m 755 -g bin -o bin jpilotrc.green @prefix@/share/jpilot
	./install-sh -c -m 755 -g bin -o bin jpilotrc.purple @prefix@/share/jpilot
	./install-sh -c -m 755 -g bin -o bin jpilotrc.steel @prefix@/share/jpilot
	./install-sh -c -m 755 -g bin -o bin empty/DatebookDB.pdb @prefix@/share/jpilot
	./install-sh -c -m 755 -g bin -o bin empty/AddressDB.pdb @prefix@/share/jpilot
	./install-sh -c -m 755 -g bin -o bin empty/ToDoDB.pdb @prefix@/share/jpilot
	./install-sh -c -m 755 -g bin -o bin empty/MemoDB.pdb @prefix@/share/jpilot

uninstall:
	rm @prefix@/share/jpilot/*
	rm @prefix@/bin/jpilot
